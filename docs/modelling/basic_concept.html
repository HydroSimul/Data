<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HydroSimul - Concept of Modelling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../modelling/model_linearReservoir.html" rel="next">
<link href="../modelling/index.html" rel="prev">
<link href="../Kan.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">HydroSimul</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../dataprocess/index.html" rel="" target="">
 <span class="menu-text">Dataprocess</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../modelling/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Modelling</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../modelling/index.html">Modelling</a></li><li class="breadcrumb-item"><a href="../modelling/basic_concept.html">Concept of Modelling</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../modelling/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modelling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modelling/basic_concept.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Concept of Modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modelling/model_linearReservoir.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Reservoir</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../modelling/model_caliLinearReser.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calibration Prozess</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data" id="toc-data" class="nav-link active" data-scroll-target="#data"><span class="header-section-number">1</span> Data</a>
  <ul class="collapse">
  <li><a href="#boundary-condition-forcing-data" id="toc-boundary-condition-forcing-data" class="nav-link" data-scroll-target="#boundary-condition-forcing-data"><span class="header-section-number">1.1</span> Boundary Condition (Forcing Data)</a></li>
  <li><a href="#initial-condition-data-warm-up-time" id="toc-initial-condition-data-warm-up-time" class="nav-link" data-scroll-target="#initial-condition-data-warm-up-time"><span class="header-section-number">1.2</span> Initial Condition Data &amp; Warm-up Time</a></li>
  <li><a href="#parameter" id="toc-parameter" class="nav-link" data-scroll-target="#parameter"><span class="header-section-number">1.3</span> Parameter</a>
  <ul class="collapse">
  <li><a href="#initial-parameters" id="toc-initial-parameters" class="nav-link" data-scroll-target="#initial-parameters"><span class="header-section-number">1.3.1</span> Initial Parameters</a></li>
  <li><a href="#parameter-range" id="toc-parameter-range" class="nav-link" data-scroll-target="#parameter-range"><span class="header-section-number">1.3.2</span> Parameter Range</a></li>
  <li><a href="#calibrated-parameters" id="toc-calibrated-parameters" class="nav-link" data-scroll-target="#calibrated-parameters"><span class="header-section-number">1.3.3</span> Calibrated Parameters</a></li>
  <li><a href="#validated-parameters" id="toc-validated-parameters" class="nav-link" data-scroll-target="#validated-parameters"><span class="header-section-number">1.3.4</span> Validated Parameters</a></li>
  <li><a href="#parameter-mapping-with-groups" id="toc-parameter-mapping-with-groups" class="nav-link" data-scroll-target="#parameter-mapping-with-groups"><span class="header-section-number">1.3.5</span> Parameter Mapping with Groups</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#process" id="toc-process" class="nav-link" data-scroll-target="#process"><span class="header-section-number">2</span> Process</a>
  <ul class="collapse">
  <li><a href="#model-running" id="toc-model-running" class="nav-link" data-scroll-target="#model-running"><span class="header-section-number">2.1</span> Model Running</a></li>
  <li><a href="#evaluation" id="toc-evaluation" class="nav-link" data-scroll-target="#evaluation"><span class="header-section-number">2.2</span> Evaluation</a></li>
  <li><a href="#uncertainty-and-sensitivity" id="toc-uncertainty-and-sensitivity" class="nav-link" data-scroll-target="#uncertainty-and-sensitivity"><span class="header-section-number">2.3</span> Uncertainty and sensitivity</a></li>
  <li><a href="#calibration" id="toc-calibration" class="nav-link" data-scroll-target="#calibration"><span class="header-section-number">2.4</span> Calibration</a></li>
  <li><a href="#validation" id="toc-validation" class="nav-link" data-scroll-target="#validation"><span class="header-section-number">2.5</span> Validation</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Concept of Modelling</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Within the process of hydrological modeling, there are fundamental concepts that play a crucial role. In this article, we will elucidate these concepts through illustrative figures, enhancing your comprehension. These concepts can be categorized into two main parts: the <strong>Data</strong> part, which encompasses aspects related to <strong>input data</strong>, <strong>parameters</strong>, and <strong>parameter ranges</strong>, and the <strong>Process</strong> part, which outlines the workflow of the entire modeling process. By exploring these concepts and their visual representations, you’ll gain a deeper understanding of hydrological modeling.</p>
<section id="data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data</h1>
<p>In terms of data, it can encompass various types of information, including <strong>forcing data</strong> such as time series, <strong>initial states</strong>, as well as the <strong>parameters</strong>. These values are essential inputs that the model relies on during the simulation process.</p>
<section id="boundary-condition-forcing-data" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="boundary-condition-forcing-data"><span class="header-section-number">1.1</span> Boundary Condition (Forcing Data)</h2>
<p>For hydrological modeling, you need data that describes the <strong>boundary conditions</strong> or forcing factors affecting the model. They define how water and other related variables enter or exit the modeled domain. This includes information on precipitation, temperature, humidity, and other <strong>meteorological variables</strong>.</p>
<p><img src="../images/model_bcic.svg" class="img-fluid"></p>
</section>
<section id="initial-condition-data-warm-up-time" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="initial-condition-data-warm-up-time"><span class="header-section-number">1.2</span> Initial Condition Data &amp; Warm-up Time</h2>
<p>Initial conditions represent the <strong>state</strong> of the watershed or catchment at the <strong>beginning</strong> of the simulation.</p>
<p>However, in many cases, the exact initial conditions are <strong>unknown or difficult to measure</strong> accurately. To address this uncertainty, hydrological models incorporate a warm-up period. This warm-up period refers to the initial phase of model simulation where the model runs to establish a stable or equilibrium state before commencing the actual simulation.</p>
<p>It’s crucial to ensure that the <strong>warm-up period</strong> is of sufficient duration to reach a stable state. Typically, this period should span <strong>at least two complete cycles</strong> of the dominant hydrological processes within the watershed. This requirement ensures that the model has the opportunity to capture the full range of variability associated with these processes.</p>
<p>The <strong>periodicity</strong> of hydrological processes is a crucial consideration when implementing a warm-up period. By assuming that the initial state during warm-up has only a minimal influence, we rely on the repeated cycles of hydrological events. During the second cycle, the system tends to <strong>reach its maximum or minimum state</strong>, which is indicative of equilibrium. Subsequently, the simulation becomes stable, and this equilibrium state serves as the initial condition for the formal simulation.</p>
<p><img src="../images/model_warmup.svg" class="img-fluid"></p>
</section>
<section id="parameter" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="parameter"><span class="header-section-number">1.3</span> Parameter</h2>
<p><strong>Parameters</strong> are essential components of hydrological models for several reasons. Firstly, hydrological models cannot simulate the entire complexity of the real world, so parameters are used to represent various physical characteristics and processes. Secondly, real-world measurements are often limited in scope and may not capture all relevant data across the entire watershed. Parameters help bridge these gaps by allowing models to make predictions based on available information.</p>
<p>There are three main categories of hydrological models based on their use of parameters:</p>
<ol type="1">
<li><p><strong>Physical-based models</strong> (white box): These models aim to simulate hydrological processes with a high level of detail. They rely on deterministic formulas and aim to represent physical processes as accurately as possible. Ideally, physical-based models do not require the use of parameters, as all processes are simulated with detailed data and deterministic equations. However, in practice, some level of parameterization may still be necessary, especially for processes that are not well understood or difficult to represent mathematically.</p></li>
<li><p><strong>Conceptual models</strong> (gray box): Conceptual models are the most commonly used hydrological models. They strike a balance between complexity and simplicity. These models use parameters to <strong>represent various physical characteristics</strong> of the watershed, such as soil properties, land use, and drainage patterns. Calibration, a process of adjusting parameter values to match observed data, is typically needed to make the model’s predictions consistent with real-world conditions.</p></li>
<li><p><strong>Empirical and data-driven models</strong> (black box): Empirical models rely heavily on observed data and may not explicitly represent physical processes. Instead, they use statistical relationships to make predictions. These models often require fewer parameters than physical-based or conceptual models but may still involve parameter estimation based on data.</p></li>
</ol>
<section id="initial-parameters" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="initial-parameters"><span class="header-section-number">1.3.1</span> Initial Parameters</h3>
<p>Initial parameters are the <strong>starting values</strong> for model parameters that are often suggested based on previous research or prior knowledge. These initial parameter values are used to test the fundamental functionality of the model and its applicability to the study area. While these initial parameters may provide a reasonable starting point, they may or may not be a good fit for the specific study area and objectives.</p>
</section>
<section id="parameter-range" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="parameter-range"><span class="header-section-number">1.3.2</span> Parameter Range</h3>
<p>Parameter ranges define the range of allowable values that model parameters can assume within specified bounds. While a <strong>broad</strong> parameter range can provide a <strong>greater opportunity</strong> to find optimal parameter values, it also expands the search space, making it more <strong>challenging</strong> to identify the best-fitting parameters.</p>
<p>Parameter ranges can be categorized into two main types:</p>
<ol type="1">
<li><p><strong>Physical Range</strong>: This refers to the range of parameter values that are physically meaningful and are constrained by the fundamental characteristics of the system being modeled. For example, hydraulic conductivity in groundwater models cannot be negative, so it has a physical lower bound of zero. Physical range limits ensure that parameter values are consistent with the underlying physical processes.</p></li>
<li><p><strong>Regional Range</strong>: In addition to the physical limits, parameters may have regional variations based on the specific characteristics of the study area. These regional variations account for local geological, climatic, or land-use differences that influence parameter values. Regional ranges help to capture the heterogeneity within a larger study domain and allow for parameterization that reflects local conditions.</p></li>
</ol>
<p>Balancing the scope of parameter ranges is essential in hydrological modeling. While broader ranges offer flexibility, they also increase the complexity of parameter estimation. The challenge lies in finding a balance that allows for the exploration of diverse parameter values while ensuring that the model remains physically meaningful and regionally applicable.</p>
</section>
<section id="calibrated-parameters" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="calibrated-parameters"><span class="header-section-number">1.3.3</span> Calibrated Parameters</h3>
<p>Calibrated parameters are the parameter set that has been <strong>adjusted and fine-tuned</strong> during the calibration process. These parameters represent the <strong>current best-fit</strong> values for the hydrological model in a specific study area. They are chosen to optimize the model’s performance and ensure that it provides accurate predictions and simulations based on observed data.</p>
</section>
<section id="validated-parameters" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="validated-parameters"><span class="header-section-number">1.3.4</span> Validated Parameters</h3>
<p>Validated parameters are parameters that have been **verified* through comparison with observed data to ensure that the model accurately represents the real-world system.</p>
</section>
<section id="parameter-mapping-with-groups" class="level3" data-number="1.3.5">
<h3 data-number="1.3.5" class="anchored" data-anchor-id="parameter-mapping-with-groups"><span class="header-section-number">1.3.5</span> Parameter Mapping with Groups</h3>
<p>Parameters in hydrological modeling vary based on the <strong>physical characteristics</strong> of the system being studied. However, in reality, different regions within a study area often exhibit distinct physical characteristics. Consequently, when performing simulations, it becomes necessary to calibrate parameters for each Hydrological Response Unit (HRU), which represents a homogeneous area within the study domain.</p>
<p>Calibrating parameters for every HRU can be a <strong>formidable</strong> task, as it would involve a substantial number of individual calibrations. To address this challenge, researchers often employ a strategy of <strong>grouping</strong> HRUs with similar characteristics. By doing so, they can map parameters to these groups, effectively reducing the parameter calibration space.</p>
<p>One of the most commonly used grouping criteria includes categorizing HRUs based on factors such as land use, soil type, soil class, or climate zone. These characteristics often play a significant role in shaping the hydrological behavior of a region.</p>
</section>
</section>
</section>
<section id="process" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Process</h1>
<p>In hydrological modeling, there are several common steps, including model running, calibration, validation, and uncertainty and sensitivity analysis, which collectively form the essential framework for model development and evaluation.</p>
<section id="model-running" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="model-running"><span class="header-section-number">2.1</span> Model Running</h2>
<p>The core step in hydrological modeling involves running the model, which treats the model as a function that calculates a process with the input data to produce output data.</p>
<p><img src="../images/model_function.svg" class="img-fluid" style="width:30.0%"></p>
<p>This process utilizes the provided boundary conditions, initial conditions, and parameter values to <strong>simulate</strong> the hydrological processes within the watershed or catchment. Boundary conditions and initial conditions are often collectively referred to as forcing data or input data.</p>
<p><img src="../images/model_model.svg" class="img-fluid" style="width:60.0%"></p>
</section>
<section id="evaluation" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="evaluation"><span class="header-section-number">2.2</span> Evaluation</h2>
<p>After the model run, an evaluation process is conducted to assess the <strong>performance</strong> of the model. This involves comparing the model’s <strong>simulated output to observed data</strong> or reference values. Various performance metrics and statistical measures are used to determine how well the model simulates real-world conditions.</p>
<p><img src="../images/model_evalute.svg" class="img-fluid" style="width:90.0%"></p>
</section>
<section id="uncertainty-and-sensitivity" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="uncertainty-and-sensitivity"><span class="header-section-number">2.3</span> Uncertainty and sensitivity</h2>
<p>Uncertainty and sensitivity analysis are crucial components of hydrological modeling, helping us understand the reliability of model predictions and the influence of different input <strong>parameters</strong>. Uncertainty analysis assesses the overall uncertainty in model outputs, considering various sources of uncertainty, while sensitivity analysis identifies which input parameters have the most <strong>significant impact</strong> on model results. Together, they provide valuable insights into the robustness and reliability of hydrological models.</p>
</section>
<section id="calibration" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="calibration"><span class="header-section-number">2.4</span> Calibration</h2>
<p>Calibration is a critical step in hydrological modeling. It involves <strong>adjusting</strong> the model’s parameters to improve its accuracy and alignment with observed data. Optimization techniques are often used to find parameter values that minimize the difference between model output and observed data.</p>
<p><img src="../images/model_calibrate.svg" class="img-fluid"></p>
</section>
<section id="validation" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="validation"><span class="header-section-number">2.5</span> Validation</h2>
<p>Once the model has been calibrated, it is essential to validate its performance. Validation involves <strong>testing the calibrated model</strong> against <strong>independent datasets</strong> or data from a different time period. This step ensures that the model’s performance is not solely tailored to the calibration data but remains reliable for a broader range of conditions.</p>
<p><img src="../images/model_validate.svg" class="img-fluid" style="width:90.0%"></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../modelling/index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Modelling</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../modelling/model_linearReservoir.html" class="pagination-link">
        <span class="nav-page-text">Linear Reservoir</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>