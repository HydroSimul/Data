<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HydroSimul - Data Loading</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../dataprocess/basic_r_python.html" rel="prev">
<link href="../Kan.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">HydroSimul</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../dataset/index.html" rel="" target="">
 <span class="menu-text">Dataset</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../dataprocess/index.html" rel="" target="" aria-current="page">
 <span class="menu-text">Dataprocess</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../dataprocess/index.html">Dataprocess</a></li><li class="breadcrumb-item"><a href="../dataprocess/basic_r_python.html">Processing with Skript</a></li><li class="breadcrumb-item"><a href="../dataprocess/data_load.html">Data Loading</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../dataprocess/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dataprocess</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Data Format</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dataprocess/basic_format.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic format</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dataprocess/NetCDF.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NetCDF</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dataprocess/spatial_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">spatial data</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Processing with Skript</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dataprocess/basic_r_python.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R &amp; Python Basic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../dataprocess/data_load.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data Loading</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#plain-text-file" id="toc-plain-text-file" class="nav-link active" data-scroll-target="#plain-text-file"><span class="header-section-number">1</span> Plain text File</a>
  <ul class="collapse">
  <li><a href="#example-file" id="toc-example-file" class="nav-link" data-scroll-target="#example-file"><span class="header-section-number">1.1</span> Example File</a></li>
  <li><a href="#library-and-functions" id="toc-library-and-functions" class="nav-link" data-scroll-target="#library-and-functions"><span class="header-section-number">1.2</span> Library and functions</a></li>
  <li><a href="#metadata-handel" id="toc-metadata-handel" class="nav-link" data-scroll-target="#metadata-handel"><span class="header-section-number">1.3</span> Metadata Handel</a>
  <ul class="collapse">
  <li><a href="#directly-ignore-use-grguments-skip" id="toc-directly-ignore-use-grguments-skip" class="nav-link" data-scroll-target="#directly-ignore-use-grguments-skip"><span class="header-section-number">1.3.1</span> Directly Ignore use grguments <code>skip</code></a></li>
  <li><a href="#read-metadata-as-table" id="toc-read-metadata-as-table" class="nav-link" data-scroll-target="#read-metadata-as-table"><span class="header-section-number">1.3.2</span> Read metadata as table</a></li>
  </ul></li>
  <li><a href="#load-tabular-data" id="toc-load-tabular-data" class="nav-link" data-scroll-target="#load-tabular-data"><span class="header-section-number">1.4</span> Load tabular data</a></li>
  <li><a href="#sec-datatype" id="toc-sec-datatype" class="nav-link" data-scroll-target="#sec-datatype"><span class="header-section-number">1.5</span> Data type</a></li>
  </ul></li>
  <li><a href="#excel-file" id="toc-excel-file" class="nav-link" data-scroll-target="#excel-file"><span class="header-section-number">2</span> Excel File</a>
  <ul class="collapse">
  <li><a href="#example-file-1" id="toc-example-file-1" class="nav-link" data-scroll-target="#example-file-1"><span class="header-section-number">2.1</span> Example File</a></li>
  <li><a href="#r-library-and-functions" id="toc-r-library-and-functions" class="nav-link" data-scroll-target="#r-library-and-functions"><span class="header-section-number">2.2</span> R library and functions</a></li>
  <li><a href="#load-tabular-data-1" id="toc-load-tabular-data-1" class="nav-link" data-scroll-target="#load-tabular-data-1"><span class="header-section-number">2.3</span> Load tabular data</a>
  <ul class="collapse">
  <li><a href="#first-try-without-any-setting" id="toc-first-try-without-any-setting" class="nav-link" data-scroll-target="#first-try-without-any-setting"><span class="header-section-number">2.3.1</span> First try without any setting</a></li>
  <li><a href="#give-a-range" id="toc-give-a-range" class="nav-link" data-scroll-target="#give-a-range"><span class="header-section-number">2.3.2</span> Give a <code>range</code></a></li>
  </ul></li>
  <li><a href="#data-type" id="toc-data-type" class="nav-link" data-scroll-target="#data-type"><span class="header-section-number">2.4</span> Data type</a></li>
  </ul></li>
  <li><a href="#netcdf" id="toc-netcdf" class="nav-link" data-scroll-target="#netcdf"><span class="header-section-number">3</span> NetCDF</a></li>
  <li><a href="#sec-string" id="toc-sec-string" class="nav-link" data-scroll-target="#sec-string"><span class="header-section-number">4</span> Text &amp; String</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Data Loading</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This Aritcl will show the process to load data from other files. I t will divide into four paties: plain text (read able ASCII), Excel, NetCDF and spatial data.</p>
<section id="plain-text-file" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Plain text File</h1>
<p>For more details about date (file) format, you can refer to the article titled <a href="../dataprocess/basic_format.html">Basic Data &amp; File Format</a>.</p>
<section id="example-file" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="example-file"><span class="header-section-number">1.1</span> Example File</h2>
<p>Let’s start with an example CSV file named <code>Bachum_2763190000100.csv</code>. This file contains pegel discharge data and is sourced from open data available at <a href="https://www.elwasweb.nrw.de/elwas-web/index.xhtml">ELWAS-WEB NRW</a>. You can also access it directly from the internet via <a href="https://raw.githubusercontent.com/HydroSimul/Web/main/data_share/Bachum_2763190000100.csv">Github</a>, just like you would access a local file.</p>
<p>Take a look:</p>
<p><img src="../images/bachum.png" class="img-fluid"></p>
</section>
<section id="library-and-functions" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="library-and-functions"><span class="header-section-number">1.2</span> Library and functions</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>First, we need to load the necessary library <code>tidyverse</code>. This library collection includes <code>readr</code> for reading files and <code>dplyr</code> for data manipulation, among others.</p>
<p>And, we set the URL address as the file path (including the file name).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the library</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>fn_Bachum <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/HydroSimul/Web/main/data_share/Bachum_2763190000100.csv"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The documentation for the <code>readr</code> library is available online and can be accessed at <a href="https://readr.tidyverse.org">https://readr.tidyverse.org</a>.</p>
<p>Of particular interest are the following functions:</p>
<ul>
<li><a href="https://readr.tidyverse.org/reference/read_delim.html">readr::read_csv()</a></li>
<li><a href="https://readr.tidyverse.org/reference/read_table.html">readr::read_table()</a></li>
</ul>
<p>We can observe that the CSV file is divided by semicolons. Therefore, it’s more appropriate to use <code>read_csv2()</code> rather than <code>read_csv()</code>.</p>
<p>The difference between <code>read_*()</code> functions in the <code>readr</code> package is determined by the delimiter character used in the files:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/readr_read_.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">CHEAT SHEET from <a href="https://github.com/rstudio/cheatsheets/blob/main/data-import.pdf">Rstudio</a></figcaption>
</figure>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the library</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fn_Bachum <span class="op">=</span> <span class="st">"C:\Lei\HS_Web\data_share/Bachum_2763190000100.csv"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The documentation for the <code>pandas</code> library is available online and can be accessed at <a href="https://pandas.pydata.org/docs/index.html">https://pandas.pydata.org/docs/index.html</a>.</p>
<p>Of particular interest are the following functions:</p>
<ul>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">pandas.read_csv()</a></li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.read_table.html">pandas.read_table()</a></li>
</ul>
</div>
</div>
</div>
</section>
<section id="metadata-handel" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="metadata-handel"><span class="header-section-number">1.3</span> Metadata Handel</h2>
<p>Metadata can vary widely between datasets, so it’s handled separately from the data body.</p>
<p>There are three ways to deal with metadata:</p>
<ol type="1">
<li><p><strong>Directly Ignore:</strong> This approach involves ignoring metadata when it’s redundant or readily available from other data sources, such as file names or external references.</p></li>
<li><p><strong>Extract from Text:</strong> When metadata is crucial but not in table form, you can extract information from text strings. For more information, refer to the section on string manipulation <a href="#sec-string">Section&nbsp;4</a>.</p></li>
<li><p><strong>Read as a Second Table:</strong> If metadata is well-organized in a tabular format, it can be read as a separate table to facilitate its use.</p></li>
</ol>
<p>In the <code>Bachum_2763190000100.csv</code> file, you will find that there are 10 lines of metadata, which are well-organized in a tabular format. However, it’s important to note that the consistency in values column varies.</p>
<section id="directly-ignore-use-grguments-skip" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="directly-ignore-use-grguments-skip"><span class="header-section-number">1.3.1</span> Directly Ignore use grguments <code>skip</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># skip = 10</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv2</span>(fn_Bachum, <span class="at">skip =</span> <span class="dv">10</span>, <span class="at">n_max =</span> <span class="dv">10</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   X1            X2
   &lt;chr&gt;      &lt;dbl&gt;
 1 01.01.1990  20.6
 2 02.01.1990  19.0
 3 03.01.1990  17.9
 4 04.01.1990  16.8
 5 05.01.1990  16.0
 6 06.01.1990  14.8
 7 07.01.1990  14.3
 8 08.01.1990  14.0
 9 09.01.1990  14.4
10 10.01.1990  14.5</code></pre>
</div>
</div>
</section>
<section id="read-metadata-as-table" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="read-metadata-as-table"><span class="header-section-number">1.3.2</span> Read metadata as table</h3>
<p>More details in the next section:</p>
</section>
</section>
<section id="load-tabular-data" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="load-tabular-data"><span class="header-section-number">1.4</span> Load tabular data</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>To read the first 10 lines of metadata, you can use the <code>n_max</code> setting with a value of <code>n_max = 10</code> in the <code>read_csv2()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv2</span>(fn_Bachum, <span class="at">n_max =</span> <span class="dv">10</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   X1                          X2             
   &lt;chr&gt;                       &lt;chr&gt;          
 1 "Name"                      "Bachum"       
 2 "Pegelnummer"               "2763190000100"
 3 "Gew\xe4sser"               "Ruhr"         
 4 "Datum von"                 "01.01.1990"   
 5 "Datum bis"                 "31.12.2022"   
 6 "Parameter"                 "Abfluss"      
 7 "Q Einheit"                 "m\xb3/s"      
 8 "Tagesmittelwerte"           &lt;NA&gt;          
 9 "Pegelnullpunkt [m\xfcNHN]" "146,83"       
10 "Einzugsgebiet [km\xb2]"    "1.532,02"     </code></pre>
</div>
</div>
<p>After dealing with the metadata, we can proceed to load the data body using the <code>readr::read_*()</code> function cluster. Plain text files typically store data in a tabular or matrix format, both of which have at most two dimensions. When using the <code>readr::read_()</code> function, it automatically returns a <code>tibble</code>. If your data in the text file is in matrix format, you can use conversion functions like <code>as.matrix()</code> to transform it into other data structures.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. load</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>tb_Read <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(fn_Bachum, <span class="at">skip =</span> <span class="dv">10</span>, <span class="at">n_max =</span> <span class="dv">10</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>tb_Read</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   X1            X2
   &lt;chr&gt;      &lt;dbl&gt;
 1 01.01.1990  20.6
 2 02.01.1990  19.0
 3 03.01.1990  17.9
 4 04.01.1990  16.8
 5 05.01.1990  16.0
 6 06.01.1990  14.8
 7 07.01.1990  14.3
 8 08.01.1990  14.0
 9 09.01.1990  14.4
10 10.01.1990  14.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. convert</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df_Read <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(tb_Read)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>mat_Read <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(tb_Read)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>df_Read</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           X1     X2
1  01.01.1990 20.640
2  02.01.1990 18.994
3  03.01.1990 17.949
4  04.01.1990 16.779
5  05.01.1990 16.019
6  06.01.1990 14.817
7  07.01.1990 14.296
8  08.01.1990 13.952
9  09.01.1990 14.403
10 10.01.1990 14.500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mat_Read</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      X1           X2      
 [1,] "01.01.1990" "20.640"
 [2,] "02.01.1990" "18.994"
 [3,] "03.01.1990" "17.949"
 [4,] "04.01.1990" "16.779"
 [5,] "05.01.1990" "16.019"
 [6,] "06.01.1990" "14.817"
 [7,] "07.01.1990" "14.296"
 [8,] "08.01.1990" "13.952"
 [9,] "09.01.1990" "14.403"
[10,] "10.01.1990" "14.500"</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tb_Read <span class="op">=</span> pd.read_csv(fn_Bachum, skiprows<span class="op">=</span><span class="dv">10</span>, nrows<span class="op">=</span><span class="dv">10</span>, header<span class="op">=</span><span class="va">None</span>, delimiter<span class="op">=</span><span class="st">';'</span>, decimal<span class="op">=</span><span class="st">','</span>, encoding<span class="op">=</span><span class="st">'latin-1'</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tb_Read)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            0       1
0  01.01.1990  20.640
1  02.01.1990  18.994
2  03.01.1990  17.949
3  04.01.1990  16.779
4  05.01.1990  16.019
5  06.01.1990  14.817
6  07.01.1990  14.296
7  08.01.1990  13.952
8  09.01.1990  14.403
9  10.01.1990  14.500</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="sec-datatype" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="sec-datatype"><span class="header-section-number">1.5</span> Data type</h2>
<p>When directly reading all metadata into one table, you may encounter mixed data types. In the metadata, there are three data types:</p>
<ul>
<li>Numeric: Examples include <code>Pegelnullpunkt</code> and <code>Einzugsgebiet</code>.</li>
<li>String: This category covers fields like <code>Name</code>, <code>Pegelnummer</code>, and others.</li>
<li>Date: Date values are present in columns like <code>Datum von</code> and <code>Datum bis</code>.</li>
</ul>
<p>In a data frame (tibble), columns must have the same data type. Consequently, R will automatically convert them to a single data type, which is typically string.</p>
<p>To address this situation, you should specify the data type you want to read. For example, to read the date values in lines 4 and 5, you can use the following settings: 1. <code>skip = 3</code> to skip the first three lines of metadata. 2. <code>n_max = 2</code> to read the next two lines (lines 4 and 5) as date values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># skip = 10</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv2</span>(fn_Bachum, <span class="at">skip =</span> <span class="dv">3</span>, <span class="at">n_max =</span> <span class="dv">2</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  X1        X2        
  &lt;chr&gt;     &lt;chr&gt;     
1 Datum von 01.01.1990
2 Datum bis 31.12.2022</code></pre>
</div>
</div>
<p>Unfortunately, R may not always recognize date values correctly, so you may need to perform additional steps for conversion:</p>
<ol type="1">
<li><p><strong>After Reading:</strong> This involves transforming the data from its initial format to the desired date format within your R environment.</p></li>
<li><p><strong>Set the Data Type by Reading:</strong> Another approach is to set the data type while reading the data.</p></li>
</ol>
<p>To address the issue of date recognition, you can set the <code>col_types</code> parameter to <code>"cD"</code> when reading the data. This informs the function that the first column contains <code>c</code>haracters (<code>c</code>) and the second column contains <code>D</code>ates (<code>D</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># skip = 10</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv2</span>(fn_Bachum, <span class="at">skip =</span> <span class="dv">3</span>, <span class="at">n_max =</span> <span class="dv">2</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>, <span class="at">col_types =</span> <span class="st">"cD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  X1        X2    
  &lt;chr&gt;     &lt;date&gt;
1 Datum von NA    
2 Datum bis NA    </code></pre>
</div>
</div>
<p>Unfortunately, the default date format in R may not work for German-style dates like “d.m.Y,” as R primarily recognizes the “Y-m-d” format. To handle this, you can convert the dates using function <code>as.Date()</code> and specify the date format using the <code>format</code> argument, such as <code>format = "%d.%m.%Y"</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df_Date <span class="ot">&lt;-</span> <span class="fu">read_csv2</span>(fn_Bachum, <span class="at">skip =</span> <span class="dv">3</span>, <span class="at">n_max =</span> <span class="dv">2</span>, <span class="at">col_names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df_Date<span class="sc">$</span>X2 <span class="ot">&lt;-</span> df_Date<span class="sc">$</span>X2 <span class="sc">|&gt;</span> <span class="fu">as.Date</span>(<span class="at">format =</span> <span class="st">"%d.%m.%Y"</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df_Date</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  X1        X2        
  &lt;chr&gt;     &lt;date&gt;    
1 Datum von 1990-01-01
2 Datum bis 2022-12-31</code></pre>
</div>
</div>
</section>
</section>
<section id="excel-file" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Excel File</h1>
<p>When we discuss the combination of the software Excel with data files in formats such as .xls or .xlsx, there are numerous possibilities for data science. However, when we specifically consider the file format, there are distinct differences between plain text and Excel files:</p>
<p><strong>Plain Text File vs.&nbsp;Excel for Data Storage</strong></p>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 34%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>Plain Text File</th>
<th>Excel File</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Data Structure</strong></td>
<td>Typically stores data in a tabular format or matrix.</td>
<td>Stores data in structured worksheets with multiple tables (sheets).</td>
</tr>
<tr class="even">
<td><strong>Compatibility</strong></td>
<td>Universally compatible with various software and programming languages.</td>
<td>Compatibility may vary, and not all software can read Excel files.</td>
</tr>
<tr class="odd">
<td><strong>Human-Readable</strong></td>
<td>Easily readable by humans in a simple text format.</td>
<td>Readable by humans but may include formatting that isn’t immediately apparent.</td>
</tr>
<tr class="even">
<td><strong>Data Transfer</strong></td>
<td>Easily shared and transferred between different platforms and systems.</td>
<td>May require conversion or specific software for seamless data transfer.</td>
</tr>
<tr class="odd">
<td><strong>Data Import/Export</strong></td>
<td>May require custom import/export scripts for specific applications.</td>
<td>Supports standardized import/export formats for various applications.</td>
</tr>
<tr class="even">
<td><strong>Version Control</strong></td>
<td>Suitable for version control systems (e.g., Git) for tracking changes.</td>
<td>Not well-suited for version control due to binary format and complex changes.</td>
</tr>
<tr class="odd">
<td><strong>Data Analysis</strong></td>
<td>Requires additional software to analyze data (e.g., R or Python).</td>
<td>Offers built-in data analysis tools (e.g., formulas, charts).</td>
</tr>
<tr class="even">
<td><strong>Openness and Access</strong></td>
<td>Open and transparent; data can be accessed and edited with any text editor.</td>
<td>Proprietary format may require specific software (Microsoft Excel) to access and edit.</td>
</tr>
</tbody>
</table>
<p>Unlike plain text files, Excel files have the capability to contain multiple tables, known as sheets. In Excel, each cell within a sheet is uniquely identified by its specific coordinates. Rows are indexed with numerical values, and columns are identified using alphabetical indices. By combining the sheet name with these coordinates, it is possible to precisely locate any cell within an Excel file and retrieve the value it contains.</p>
<section id="example-file-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="example-file-1"><span class="header-section-number">2.1</span> Example File</h2>
<p>Let’s begin with an example Excel file named <code>Pegeln_NRW.xlsx</code>. This file contains information about measurement stations in NRW (Nordrhein-Westfalen, Germany) and is sourced from open data available at <a href="https://www.elwasweb.nrw.de/elwas-web/index.xhtml">ELWAS-WEB NRW</a>. You can also access it directly from <a href="https://github.com/HydroSimul/Web/blob/main/data_share/Pegeln_NRW.xlsx">Github</a>.</p>
<p>Take a look:</p>
<p><img src="../images/dataload_excel_pegeln.png" class="img-fluid"></p>
</section>
<section id="r-library-and-functions" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="r-library-and-functions"><span class="header-section-number">2.2</span> R library and functions</h2>
<p>To load the necessary library, <code>readxl</code>, and access its help documentation, you can visit <a href="https://readxl.tidyverse.org/">this link</a>. The <code>readxl::read_excel()</code> function is versatile, as it can read both .xls and .xlsx files and automatically detects the format based on the file extension. Additionally, you have the options of using <code>read_xls()</code> for .xls files and <code>read_xlsx()</code> for .xlsx files. More details in the <a href="https://readxl.tidyverse.org/reference/read_excel.html">Page</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the library</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The Excel file cannot be read directly from GitHub. You will need to download it to your local machine first</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>fn_Pegeln <span class="ot">&lt;-</span> <span class="st">"C:</span><span class="sc">\\</span><span class="st">Lei</span><span class="sc">\\</span><span class="st">HS_Web</span><span class="sc">\\</span><span class="st">data_share/Pegeln_NRW.xlsx"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-tabular-data-1" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="load-tabular-data-1"><span class="header-section-number">2.3</span> Load tabular data</h2>
<p>Similar to plain text files, metadata is often provided before the data body in Excel files. In Excel, each cell can be assigned a specific data type, while in R tables (data.frame or tibble), every column must have the same data type. This necessitates separate handling of metadata and data body to ensure that the correct data types are maintained.</p>
<p>Unlike plain text files where we can only select lines to load, Excel allows us to define coordinates to access a specific celles-box wherever they are located.</p>
<section id="first-try-without-any-setting" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="first-try-without-any-setting"><span class="header-section-number">2.3.1</span> First try without any setting</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># try without setting</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>tb_Pegeln <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(fn_Pegeln)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>tb_Pegeln</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 277 × 16
   Suchergebnisse Pegel.…¹ ...2  ...3  ...4  ...5  ...6  ...7  ...8  ...9  ...10
   &lt;chr&gt;                   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 "Suchkriterien:\n -- \… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 2  &lt;NA&gt;                   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 3  &lt;NA&gt;                   &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
 4 "Name"                  Pege… Gewä… Betr… Pege… Einz… Q von Q bis NQ    MNQ  
 5 "Ahlen"                 3211… Werse LANU… 73,47 46,62 1975  2013  0     0,07 
 6 "Ahmsen"                4639… Werre LANU… 64,28 593   1963  2022  1,21  2,22 
 7 "Ahrhütte-Neuhof"       2718… Ahr   LANU… 340,… 124   1986  2011  0,22  0,36 
 8 "Albersloh"             3259… Werse LANU… 48,68 321,… 1973  2020  0,12  0,24 
 9 "Altena"                2766… Lenne LANU… 154,… 1.190 1950  2021  1,36  6,48 
10 "Altena_Rahmedestraße"  2766… Rahm… LANU… 157,… 29,6  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
# ℹ 267 more rows
# ℹ abbreviated name: ¹​`Suchergebnisse Pegel.xlsx 14.09.2023 10:01`
# ℹ 6 more variables: ...11 &lt;chr&gt;, ...12 &lt;chr&gt;, ...13 &lt;chr&gt;, ...14 &lt;chr&gt;,
#   ...15 &lt;chr&gt;, ...16 &lt;chr&gt;</code></pre>
</div>
</div>
<p>When we provide only the file name to the function, we will always retrieve all the content from the first sheet. However, due to the limitations in R tables, every column will be recognized as the same data type, typically character.</p>
</section>
<section id="give-a-range" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="give-a-range"><span class="header-section-number">2.3.2</span> Give a <code>range</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using the range argument</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>tb_Pegeln_Range <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(fn_Pegeln, <span class="at">range =</span> <span class="st">"Suchergebnisse Pegel!A5:P10"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>tb_Pegeln_Range</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 16
  Name            Pegelnummer   Gewässername Betreiber  `Pegelnullpunkt [müNHN]`
  &lt;chr&gt;           &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;                   
1 Ahlen           3211000000300 Werse        LANUV, NRW 73,47                   
2 Ahmsen          4639000000100 Werre        LANUV, NRW 64,28                   
3 Ahrhütte-Neuhof 2718193000100 Ahr          LANUV, NRW 340,58                  
4 Albersloh       3259000000100 Werse        LANUV, NRW 48,68                   
5 Altena          2766930000100 Lenne        LANUV, NRW 154,22                  
# ℹ 11 more variables: `Einzugsgebiet [km²]` &lt;chr&gt;, `Q von` &lt;chr&gt;,
#   `Q bis` &lt;chr&gt;, NQ &lt;chr&gt;, MNQ &lt;chr&gt;, MQ &lt;chr&gt;, MHQ &lt;chr&gt;, HQ &lt;chr&gt;,
#   `Q Einheit` &lt;chr&gt;, `Ostwert in UTM` &lt;chr&gt;, `Nordwert in UTM` &lt;chr&gt;</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The data type of “Pegelnullpunkt [müNHN]” appears to be incorrect due to improper settings in Excel.</p>
</div>
</div>
</section>
</section>
<section id="data-type" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="data-type"><span class="header-section-number">2.4</span> Data type</h2>
<p>Compared to plain text files, Excel data already contains data type information for each cell. Therefore, the data type will be directly determined by the data type specified in Excel.</p>
<p>However, there are instances where the data type in Excel is not correctly set, so manual data type conversion may be necessary. For more details, refer to <a href="#sec-datatype">Section&nbsp;1.5</a>.</p>
</section>
</section>
<section id="netcdf" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> NetCDF</h1>
<p>the process loading of netCDF is seperated in the page</p>
</section>
<section id="sec-string" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Text &amp; String</h1>
<p>more details</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../dataprocess/basic_r_python.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">R &amp; Python Basic</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>